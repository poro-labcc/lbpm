

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Greyscale Color Model &mdash; LBPM 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Free energy model" href="../freeEnergy/freeEnergy.html" />
    <link rel="prev" title="Greyscale model" href="../greyscale/greyscale.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            LBPM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">LBPM model summary</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../color/index.html">Color model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mrt/mrt.html">MRT model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cell/cell.html">Cell model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../greyscale/greyscale.html">Greyscale model</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Greyscale Color Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#formulation">Formulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#boundary-conditions">Boundary Conditions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../freeEnergy/freeEnergy.html">Free energy model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/visit.html">Visualizing simulation data with visit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../IO/fileformat.html">I/O conventions for LBPM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developerGuide/index.html">Developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/running.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications/publications.html">Publications</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">LBPM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">User Guide</a></li>
          <li class="breadcrumb-item"><a href="../index.html">LBPM model summary</a></li>
      <li class="breadcrumb-item active">Greyscale Color Model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/userGuide/models/greyscaleColor/greyscaleColor.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="greyscale-color-model">
<h1>Greyscale Color Model<a class="headerlink" href="#greyscale-color-model" title="Link to this heading">¶</a></h1>
<p>The LBPM greyscale lattice Boltzmann model is constructed to approximate the
solution of the Darcy-Brinkman equations in grey regions coupled to a color model implementation
solution in open regions. A simple constitutive form is used to model the relative
permeability in the grey regions,</p>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<p>The essential model parameters for the color model are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code> – control the interfacial tension between fluids – <span class="math">0 &lt; \alpha &lt; 0.01</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beta</span></code> – control the width of the interface – <span class="math">\beta &lt; 1</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tauA</span></code> – control the viscosity of fluid A – <span class="math">0.7 &lt; \tau_A &lt; 1.5</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tauB</span></code> – control the viscosity of fluid B – <span class="math">0.7 &lt; \tau_B &lt; 1.5</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rhoA</span></code> – control the viscosity of fluid A – <span class="math">0.05 &lt; \rho_A &lt; 1.0</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rhoB</span></code> – control the viscosity of fluid B – <span class="math">0.05 &lt; \rho_B &lt; 1.0</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">greyscale_endpoint_A</span></code> – control the endpoint for greyscale components – <span class="math">S_b^{r,a}</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">greyscale_endpoint_B</span></code> – control the endpoint for greyscale components – <span class="math">S_b^{r,b}</span></p></li>
</ul>
</section>
<section id="formulation">
<h2>Formulation<a class="headerlink" href="#formulation" title="Link to this heading">¶</a></h2>
<p>The greyscale color model extends the conventional two-fluid color model such that flow through
micro-porous “grey” voxels can also be treated. Extensions to the formulation are made to:
(1) implement momentum transport behavior consistent with the single phase greyscale model
(2) adapt the re-coloring term to allow for transport through microporosity.
Mass transport LBEs are constructed to model the behavior for each fluid. Within the open pore
regions, mass transport LBEs recover the behavior of the standard two-fluid color model.
Within grey voxels the standard recoloring term is disabled so that the mass transport behavior
can be described by a different rule within the microporous regions. The endpoints are
specified based on the saturation of fluid B at which fluid A ceases to percolate, <span class="math">S_b^{r,a}</span>
and the saturation of fluid B at which fluid B ceases to percolate, <span class="math">S_b^{r,b}</span>.
The endpoints should be independently specified for each class of microporosity that is labeled
in the input image. Between the endpoint values, the effective permeability is paramaterized based on the value</p>
<div class="math">
<p><span class="math">$$
 S_{ab} = \frac{S_b - S_b^{r,b}}{S_b^{r,a} - S_b^{r,b}}
 $$</span></p>
</div><p>At the endpoints, the effective permeability is provided as an input parameter for
each fluid. When <span class="math">S_b=S_b^{r,b}</span> the effective permeability of fluid B is
zero and <span class="math">K_a=K^{r,a}</span>. Between the endpoints the Corey model predicts the
effective permeability for fluid A according to</p>
<div class="math">
<p><span class="math">$$
   K_a = K^{r,a} (1-S_{ab})^{\lambda^a}
   $$</span></p>
</div><p>where <span class="math">\lambda^a=2</span> is the Corey exponent. Likewise,
When <span class="math">S_b=S_b^{r,a}</span> the effective permeability for fluid A will be zero,
and <span class="math">K_b=K^{r,b}</span> with</p>
<div class="math">
<p><span class="math">$$
   K_b = K^{r,b} S_{ab}^{\lambda^b}
   $$</span></p>
</div><p>Two LBEs are constructed to model the mass transport,</p>
<div class="math">
<p><span class="math">$$
A_q(\bm{x} + \bm{\xi}_q \delta t, t+\delta t) = w_q N_a \Big[1 + \frac{\bm{u} \cdot \bm{\xi}_q}{c_s^2}
    + \beta  \frac{N_b}{N_a+N_b} \bm{n} \cdot \bm{\xi}_q\Big] \;
$$</span></p>
</div><div class="math">
<p><span class="math">$$
B_q(\bm{x} + \bm{\xi}_q \delta t, t+\delta t) =
    w_q N_b \Big[1 + \frac{\bm{u} \cdot \bm{\xi}_q}{c_s^2}
    - \beta  \frac{N_a}{N_a+N_b} \bm{n} \cdot \bm{\xi}_q\Big]\;,
$$</span></p>
</div><p>The number density for each fluid is obtained from the sum of the mass transport distributions</p>
<div class="math">
<p><span class="math">$$
N_a = \sum_q A_q\;, \quad    N_b = \sum_q B_q\;
$$</span></p>
</div><p>The phase indicator field is then defined as</p>
<div class="math">
<p><span class="math">$$
\phi = \frac{N_a-N_b}{N_a+N_b}
$$</span></p>
</div><p>The recoloring step incorporates the standard color model
rule to model anti-diffusion at the interface within the open pores. Within grey regions,
the anti-diffusion term must be disabled, since within grey voxels the length scale for fluid features
is smaller than the interface width produced from the color model. Within grey voxels the
two fluids are permitted to freely mix between the endpoints. Beyond the endpoints, the recoloring
term is used to drive spontaneous imbibition into the grey voxels</p>
<div class="math">
<p><span class="math">$$
   R_c =
   $$</span></p>
</div><p>The fluid density and kinematic viscosity are determined based on linear interpolation</p>
<div class="math">
<p><span class="math">$$
 \rho_0 = \frac{(1+\phi) \rho_n}{2}+ \frac{(1-\phi) \rho_w}{2} \;,
$$</span></p>
</div><div class="math">
<p><span class="math">$$
 s_\nu = \frac{(1+\phi)}{2\tau_n} +\frac{(1-\phi)}{2\tau_w} \;,
$$</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">$$
 \nu_w = \frac{1}{3}\Big(\tau_w - \frac{1}{2} \Big) \;, \quad
 \nu_n = \frac{1}{3}\Big(\tau_n - \frac{1}{2} \Big) \;.
$$</span></p>
</div><p>These values are then used to model the momentum transport.</p>
<p>A D3Q19 LBE is constructed to describe the momentum transport</p>
<div class="math">
<p><span class="math">$$
   f_q(\bm{x}_i + \bm{\xi}_q \delta t,t + \delta t) - f_q(\bm{x}_i,t) =
   \sum^{Q-1}_{k=0} M^{-1}_{qk} S_{kk} (m_k^{eq}-m_k)  + \sum^{Q-1}_{k=0} M^{-1}_{qk} (1-\frac{S_{kk}}{2}) \hat{F}_q\;,
   $$</span></p>
</div><p>The force is imposed based on the construction developed by Guo et al</p>
<div class="math">
<p><span class="math">$$
   F_i = \rho_0 \omega_i \left[\frac{\bm{e}_i \cdot \bm{a}}{c_s^2} +
   \frac{\bm{u} \bm{a}:(\bm{e}_i \bm{e}_i -c_s^2 \mathcal{I})}{\epsilon c_s^4}   \right] ,
   $$</span></p>
</div><p>The acceleration includes contributions due to the external driving force <span class="math">\bm{g}</span>
as well as a drag force due to the permeability <span class="math">K</span> and flow rate <span class="math">\bm{u}</span> with the
porosity <span class="math">\epsilon</span> and  viscosity <span class="math">\nu</span> determining the net forces acting within
a grey voxel</p>
<div class="math">
<p><span class="math">$$
   \bm{a} = - \frac{\epsilon \nu}{K} \bm{u} + \bm{F}_{cp}/\rho_0 + \epsilon \bm{g},
   $$</span></p>
</div><p>The flow velocity is defined as</p>
<div class="math">
<p><span class="math">$$
   \rho_0 \bm{u} = \sum_i \bm{e}_i f_i + \frac{\delta t}{2} \rho_0 \bm{a}.
   $$</span></p>
</div><p>Combining the previous expressions,</p>
<div class="math">
<p><span class="math">$$
   \bm{u} = \frac{\frac{1}{\rho_0}\sum_i \bm{e}_i f_i + \frac{\delta t}{2}\epsilon \bm{g} +
   \frac{\delta t}{2} \frac{\bm{F}_{cp}}{\rho_0}}{1+ \frac{\delta t}{2} \frac{\epsilon \nu}{K}}
   $$</span></p>
</div><p>Where <span class="math">\bm{F}</span> is an external body force and <span class="math">c_s^2 = 1/3</span> is the speed of sound for the LB model.
The moments are linearly indepdendent:</p>
<div class="math">
<p><span class="math">$$
   m_k = \sum_{q=0}^{18} M_{qk} f_q\;.
$$</span></p>
</div><p>The relaxation parameters are determined from the relaxation time:</p>
<div class="math">
<p><span class="math">$$
  \lambda_1 =  \lambda_2=  \lambda_9 = \lambda_{10}= \lambda_{11}= \lambda_{12}= \lambda_{13}= \lambda_{14}= \lambda_{15} = s_\nu \;,
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  \lambda_{4}= \lambda_{6}= \lambda_{8} = \lambda_{16} = \lambda_{17} = \lambda_{18}= \frac{8(2-s_\nu)}{8-s_\nu} \;,
$$</span></p>
</div><p>The non-zero equilibrium moments are defined as</p>
<div class="math">
<p><span class="math">$$
  m_1^{eq} = 19\frac{ j_x^2+j_y^2+j_z^2}{\rho_0} - 11\rho - 19 \alpha |\textbf{C}|, \\
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  m_2^{eq} = 3\rho - \frac{11( j_x^2+j_y^2+j_z^2)}{2\rho_0}, \\
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  m_4^{eq} = -\frac{2 j_x}{3}, \\
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  m_6^{eq} = -\frac{2 j_y}{3}, \\
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  m_8^{eq} = -\frac{2 j_z}{3}, \\
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  m_9^{eq} = \frac{2j_x^2-j_y^2-j_z^2}{\rho_0}+ \alpha \frac{|\textbf{C}|}{2}(2n_x^2-n_y^2-n_z^2), \\
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  m_{11}^{eq} = \frac{j_y^2-j_z^2}{\rho_0} + \alpha \frac{|\textbf{C}|}{2}(n_y^2-n_z^2), \\
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  m_{13}^{eq} = \frac{j_x j_y}{\rho_0} + \alpha \frac{|\textbf{C}|}{2} n_x n_y\;, \\
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  m_{14}^{eq} = \frac{j_y j_z}{\rho_0} + \alpha \frac{|\textbf{C}|}{2} n_y n_z\;, \\
$$</span></p>
</div><div class="math">
<p><span class="math">$$
  m_{15}^{eq} = \frac{j_x j_z}{\rho_0} + \alpha \frac{|\textbf{C}|}{2} n_x n_z\;.
$$</span></p>
</div><p>where the color gradient is determined from the phase indicator field</p>
<div class="math">
<p><span class="math">$$
\textbf{C}=\nabla \phi\;.
$$</span></p>
</div><p>and the unit normal vector is</p>
<div class="math">
<p><span class="math">$$
  \bm{n} = \frac{\textbf{C}}{|\textbf{C}|}\;.
$$</span></p>
</div></section>
<section id="boundary-conditions">
<h2>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading">¶</a></h2>
<p>Due to the nature of the contribution of the porosity to the pressure term in the Chapman-Enskog
expansion, periodic boundary conditions are recommended for <code class="docutils literal notranslate"><span class="pre">lbpm_greyscaleColor_simulator</span></code>
and can be set by setting the <code class="docutils literal notranslate"><span class="pre">BC</span></code> key values in the <code class="docutils literal notranslate"><span class="pre">Domain</span></code> section of the
input file database</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BC</span> <span class="pre">=</span> <span class="pre">0</span></code> – fully periodic boundary conditions</p></li>
</ul>
<p>For <code class="docutils literal notranslate"><span class="pre">BC</span> <span class="pre">=</span> <span class="pre">0</span></code> any mass that exits on one side of the domain will re-enter at the other
side. If the pore-structure for the image is tight, the mismatch between the inlet and
outlet can artificially reduce the permeability of the sample due to the blockage of
flow pathways at the boundary. LBPM includes an internal utility that will reduce the impact
of the boundary mismatch by eroding the solid labels within the inlet and outlet layers
(<a class="reference external" href="https://doi.org/10.1007/s10596-020-10028-9">https://doi.org/10.1007/s10596-020-10028-9</a>) to create a mixing layer.
The number mixing layers to use can be set using the key values in the <code class="docutils literal notranslate"><span class="pre">Domain</span></code> section
of the input database</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">InletLayers</span>&#160; <span class="pre">=</span> <span class="pre">5</span></code> – set the number of mixing layers to <code class="docutils literal notranslate"><span class="pre">5</span></code> voxels at the inlet</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OUtletLayers</span>&#160; <span class="pre">=</span> <span class="pre">5</span></code> – set the number of mixing layers to <code class="docutils literal notranslate"><span class="pre">5</span></code> voxels at the outlet</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../greyscale/greyscale.html" class="btn btn-neutral float-left" title="Greyscale model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../freeEnergy/freeEnergy.html" class="btn btn-neutral float-right" title="Free energy model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>