

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Greyscale model &mdash; LBPM 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Greyscale Color Model" href="../greyscaleColor/greyscaleColor.html" />
    <link rel="prev" title="Cell model" href="../cell/cell.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            LBPM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">LBPM model summary</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../color/index.html">Color model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mrt/mrt.html">MRT model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cell/cell.html">Cell model</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Greyscale model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#model-parameters">Model parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-formulation">Model formulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../greyscaleColor/greyscaleColor.html">Greyscale Color Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../freeEnergy/freeEnergy.html">Free energy model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/visit.html">Visualizing simulation data with visit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../IO/fileformat.html">I/O conventions for LBPM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developerGuide/index.html">Developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/running.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications/publications.html">Publications</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">LBPM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">User Guide</a></li>
          <li class="breadcrumb-item"><a href="../index.html">LBPM model summary</a></li>
      <li class="breadcrumb-item active">Greyscale model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/userGuide/models/greyscale/greyscale.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="greyscale-model">
<h1>Greyscale model<a class="headerlink" href="#greyscale-model" title="Link to this heading">¶</a></h1>
<p>The LBPM greyscale lattice Boltzmann model is constructed to approximate the
solution of the Darcy-Brinkman equations in grey regions, coupled to a Navier-Stokes
solution in open regions. To use the greyscale model, the input image should be segmented
into “grey” and open regions. Each particular “grey” label should be assigned both
a porosity and permeability value.</p>
<p>A typical command to launch the LBPM color simulator is as follows</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">mpirun</span> <span class="pre">-np</span> <span class="pre">$NUMPROCS</span> <span class="pre">lbpm_greyscale_simulator</span> <span class="pre">input.db</span>
<span class="pre">`</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">$NUMPROCS</span></code> is the number of MPI processors to be used and <code class="docutils literal notranslate"><span class="pre">input.db</span></code> is
the name of the input database that provides the simulation parameters.
Note that the specific syntax to launch MPI tasks may vary depending on your system.
For additional details please refer to your local system documentation.</p>
<section id="model-parameters">
<h2>Model parameters<a class="headerlink" href="#model-parameters" title="Link to this heading">¶</a></h2>
<p>The essential model parameters for the single phase greyscale model are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tau</span></code> – control the fluid viscosity – <span class="math">0.7 &lt; \tau &lt; 1.5</span></p></li>
</ul>
<p>The kinematic viscosity is given by</p>
</section>
<section id="model-formulation">
<h2>Model formulation<a class="headerlink" href="#model-formulation" title="Link to this heading">¶</a></h2>
<p>A D3Q19 LBE is constructed to describe the momentum transport</p>
<div class="math">
<p><span class="math">$$
   f_q(\bm{x}_i + \bm{\xi}_q \delta t,t + \delta t) - f_q(\bm{x}_i,t) =
   \sum^{Q-1}_{k=0} M^{-1}_{qk} S_{kk} (m_k^{eq}-m_k)  + \sum^{Q-1}_{k=0} M^{-1}_{qk} (1-\frac{S_{kk}}{2}) \hat{F}_q\;,
   $$</span></p>
</div><p>The force is imposed based on the construction developed by Guo et al</p>
<div class="math">
<p><span class="math">$$
   F_i = \rho_0 \omega_i \left[\frac{\bm{e}_i \cdot \bm{a}}{c_s^2} +
   \frac{\bm{u} \bm{a}:(\bm{e}_i \bm{e}_i -c_s^2 \mathcal{I})}{\epsilon c_s^4}   \right] ,
   $$</span></p>
</div><p>where <span class="math">c_s^2 = 1/3</span> is the speed of sound for the D3Q19 lattice.
The acceleration includes contributions due to the external driving force <span class="math">\bm{g}</span>
as well as a drag force due to the permeability <span class="math">K</span> and flow rate <span class="math">\bm{u}</span> with the
porosity <span class="math">\epsilon</span> and  viscosity <span class="math">\nu</span> determining the net forces acting within
a grey voxel</p>
<div class="math">
<p><span class="math">$$
   \bm{a} = - \frac{\epsilon \nu}{K} \bm{u} + \bm{F}_{cp}/\rho_0 + \epsilon \bm{g},
   $$</span></p>
</div><p>The flow velocity is defined as</p>
<div class="math">
<p><span class="math">$$
   \rho_0 \bm{u} = \sum_i \bm{e}_i f_i + \frac{\delta t}{2} \rho_0 \bm{a}.
   $$</span></p>
</div><p>Combining the previous expressions,</p>
<div class="math">
<p><span class="math">$$
   \bm{u} = \frac{\frac{1}{\rho_0}\sum_i \bm{e}_i f_i + \frac{\delta t}{2}\epsilon \bm{g} +
   \frac{\delta t}{2} \frac{\bm{F}_{cp}}{\rho_0}}{1+ \frac{\delta t}{2} \frac{\epsilon \nu}{K}}
   $$</span></p>
</div></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../cell/cell.html" class="btn btn-neutral float-left" title="Cell model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../greyscaleColor/greyscaleColor.html" class="btn btn-neutral float-right" title="Greyscale Color Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>